{"version":3,"sources":["webpack:///./browser/src/components/UnderlinedInput.jsx","webpack:///./browser/src/components/NavMenu.jsx","webpack:///./browser/src/components/Login.jsx"],"names":["typography","fontFamily","UnderlinedInput","value","type","padding","autofocus","props","state","setState","React","useState","placeholderPad","length","placeholder","repeat","ref","input","focus","className","style","position","left","top","zIndex","opacity","onChange","event","target","NavMenu","children","classNames","cn","navmenu","Item","selected","role","console","log","initialState","isOpen","isLoading","isError","mode","current","user","error","reducer","action","inputName","inputValue","window","location","reload","message","Error","Login","form","useRef","dispatchState","useReducer","toggleOpen","preventDefault","LoginButton","href","title","onClick","hasOwnProperty","username","LoginForm","name","RegisterForm","Modal","open","close","id","onSubmit","async","response","fetch","method","credentials","ok","result","json","collection","items","payload","password","headers","body","JSON","stringify","errors","undefined","disabled"],"mappings":"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","file":"Login_bundle.js","sourcesContent":["import React from 'react';\n\nconst typography = {\n    fontFamily: 'Press Start',\n};\n\nexport default function UnderlinedInput({ value = '', type = 'text', padding = 10, autofocus, ...props }) {\n    const [state, setState] = React.useState(value);\n    const handleChange = (event) => {\n        setState(event.target.value);\n    };\n    const placeholderPad = padding - state.length;\n    const placeholder = '_'.repeat(placeholderPad > 0 ? placeholderPad : 0);\n\n    if (autofocus) {\n        props.ref = (input) => input && input.focus();\n    }\n\n    return (\n        <div className=\"underlinedinput\" style={{ position: 'relative' }}>\n            <div className=\"underline\" style={{ position: 'absolute', left: 0, top: '.3em', zIndex: 0, ...typography }}>\n                <span style={{ opacity: 0 }}>{state}</span>\n                <span>{placeholder}</span>\n            </div>\n            <input type={type} value={state} onChange={handleChange} style={{ position: 'relative', zIndex: 1, ...typography }} {...props} />\n        </div>\n    );\n}\n","import React from 'react';\nimport cn from 'classnames';\n\nfunction NavMenu({ className, children, ...props }) {\n    const classNames = cn({\n        className,\n        navmenu: true,\n    });\n\n    return (\n        <ul className={classNames} {...props}>\n            {children}\n        </ul>\n    );\n}\n\nfunction Item({ selected, className, children, ...props }) {\n    const classNames = cn({\n        className,\n        'navmenu-item': true,\n        'navmenu-selected': selected,\n    });\n\n    return (\n        <li className={classNames} role=\"menuitem\" {...props}>\n            <span className=\"caret\">&gt;</span>\n            {children}\n        </li>\n    );\n}\n\nNavMenu.Item = Item;\n\nexport default NavMenu;\n","/* eslint-disable no-prototype-builtins */\n\n/**\n * Login component with login form\n * Note: Component is lazy loaded upon clicking login button\n */\n\nimport React from 'react';\nimport Modal from './Modal.jsx';\nimport UnderlinedInput from './UnderlinedInput.jsx';\nimport NavMenu from './NavMenu.jsx';\nimport { QuestionBlock, LoadingMascot } from '../lib/icons.js';\n\nconsole.log('<Login> has been lazy loaded!');\n\nconst API_ENDPOINT = `${process.env.API_ENDPOINT}/login`;\n\nconst initialState = {\n    isOpen: true,\n    isLoading: false,\n    isError: false,\n    mode: 'login', // login; register\n    current: 'username', // Form field to fill... username, password, email\n    user: {}, // user credentials: username, email, password\n    error: {},\n};\nconst reducer = (state, action) => {\n    switch (action.type) {\n        case 'TOGGLE':\n            return {\n                ...initialState,\n                isOpen: !state.isOpen,\n            };\n        case 'INIT':\n            return {\n                ...state,\n                isLoading: true,\n                isError: false,\n            };\n        case 'SUBMIT':\n            return {\n                ...state,\n                isLoading: false,\n                isError: false,\n                current: action.current,\n                user: {\n                    ...state.user,\n                    [action.inputName]: action.inputValue,\n                },\n            };\n        case 'REGISTER':\n            return {\n                ...state,\n                isLoading: false,\n                isError: false,\n                mode: 'register',\n            };\n        case 'LOGIN_SUCCESS':\n            window.location.reload();\n            return {\n                ...state,\n                isLoading: false,\n                isError: false,\n            };\n        case 'LOGIN_ERROR':\n            return {\n                ...state,\n                isLoading: false,\n                isError: true,\n                error: action.error ? action.error : { message: 'An error occurred.' },\n            };\n        default:\n            throw new Error();\n    }\n};\n\nexport default function Login() {\n    const form = React.useRef();\n\n    const [state, dispatchState] = React.useReducer(reducer, initialState);\n\n    const toggleOpen = (event) => {\n        event.preventDefault();\n        dispatchState({ type: 'TOGGLE' });\n    };\n\n    const handleSubmit = async (event) => {\n        event.preventDefault();\n\n        dispatchState({ type: 'INIT' });\n\n        const input = form['current'][state.current]['value'];\n\n        if (state.current === 'username') {\n            const response = await fetch(`${API_ENDPOINT}/${input}`, {\n                method: 'GET',\n                mode: 'same-origin',\n                credentials: 'same-origin',\n            });\n            if (response.ok) {\n                const result = await response.json();\n                dispatchState({\n                    type: 'SUBMIT',\n                    inputName: 'username',\n                    inputValue: result.collection.items[0].username,\n                    current: 'password',\n                });\n            } else {\n                dispatchState({ type: 'REGISTER' });\n            }\n        } else if (state.current === 'password') {\n            const payload = {\n                ...state.user,\n                password: input,\n            };\n\n            const response = await fetch(API_ENDPOINT, {\n                method: 'POST',\n                mode: 'same-origin',\n                credentials: 'same-origin',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify(payload),\n            });\n            if (response.ok) {\n                dispatchState({ type: 'LOGIN_SUCCESS' });\n            } else {\n                const result = await response.json();\n                console.log(response, result);\n                dispatchState({ type: 'LOGIN_ERROR', error: result.collection.errors[0] });\n            }\n        } else {\n            dispatchState({ type: 'LOGIN_ERROR', error: 'An unknown error occurred.' });\n        }\n    };\n\n    const LoginButton = () => (\n        <a href=\"/login.php\" title=\"Login\" onClick={toggleOpen} className=\"user user-unknown\">\n            <QuestionBlock className=\"user-avatar thumbnail\" />\n            <span className=\"user-username\">Login</span>\n        </a>\n    );\n\n    let message;\n    if (state.isError) {\n        message = <div className=\"error\">{state.error.hasOwnProperty('message') ? state.error.message : 'An error occurred'}</div>;\n    } else if (state.mode === 'login') {\n        if (state.current === 'username') message = \"Erm... What's your name again?\";\n        else if (state.current === 'password') message = `That's right! I remember now! Your name is ${state.user.username}!`;\n    } else if (state.mode === 'register') {\n        message = 'We don\\'t have anyone registered by that name. Would you like to register?';\n    }\n\n    const LoginForm = () => {\n        if (state.current === 'username') {\n            return <UnderlinedInput name=\"username\" placeholder=\"Username or Email\" padding={17} autofocus />;\n        }\n\n        return <UnderlinedInput type=\"password\" name=\"password\" placeholder=\"Password\" padding={17} autofocus />;\n    };\n\n    const RegisterForm = () => 'Register form here....';\n\n    return (\n        <>\n            <LoginButton />\n            <Modal open={state.isOpen} close={toggleOpen}>\n                <form id=\"loginform\" ref={form} onSubmit={handleSubmit} className={state.isLoading ? 'loading' : undefined}>\n                    <div id=\"loginform-nav\">\n                        <NavMenu>\n                            <NavMenu.Item selected><a href=\"#login\">New Name</a></NavMenu.Item>\n                            <NavMenu.Item><a href=\"\">Blue</a></NavMenu.Item>\n                            <NavMenu.Item><a href=\"\">Gary</a></NavMenu.Item>\n                            <NavMenu.Item><a href=\"\">John</a></NavMenu.Item>\n                        </NavMenu>\n                    </div>\n                    <div id=\"loginform-rival\" />\n                    <div id=\"loginform-message\">\n                        {message}\n                    </div>\n                    <div id=\"loginform-input\">\n                        {state.mode === 'login' ? <LoginForm /> : <RegisterForm />}\n                    </div>\n                    <div id=\"loginform-submit\">\n                        {state.isLoading ? (\n                            <>\n                                <LoadingMascot className=\"loading\" />\n                                <span>Professor Oak is thinking</span>\n                            </>\n                        ) : (\n                            <button type=\"submit\" disabled={state.isLoading}>Submit</button>\n                        )}\n                    </div>\n                </form>\n            </Modal>\n        </>\n    );\n}\n"],"sourceRoot":""}