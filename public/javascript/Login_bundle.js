(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{41:function(e,r,a){"use strict";a.r(r),a.d(r,"default",(function(){return h}));var n=a(0),t=a.n(n),s=a(10);function o(){return(o=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const l={fontFamily:"Press Start"};function i({value:e="",type:r="text",padding:a=10,autofocus:n,...s}){const[i,c]=t.a.useState(e),m=a-i.length,u="_".repeat(m>0?m:0);return n&&(s.ref=e=>e&&e.focus()),t.a.createElement("div",{className:"underlinedinput",style:{position:"relative"}},t.a.createElement("div",{className:"underline",style:{position:"absolute",left:0,top:".3em",zIndex:0,...l}},t.a.createElement("span",{style:{opacity:0}},i),t.a.createElement("span",null,u)),t.a.createElement("input",o({type:r,value:i,onChange:e=>{c(e.target.value)},style:{position:"relative",zIndex:1,...l}},s)))}var c=a(6),m=a.n(c);function u(){return(u=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function d({className:e,children:r,...a}){const n=m()({className:e,navmenu:!0});return t.a.createElement("ul",u({className:n},a),r)}d.Item=function({selected:e,className:r,children:a,...n}){const s=m()({className:r,"navmenu-item":!0,"navmenu-selected":e});return t.a.createElement("li",u({className:s,role:"menuitem"},n),t.a.createElement("span",{className:"caret"},">"),a)};var p=d,E=a(5);console.log("<Login> has been lazy loaded!");const g={isOpen:!0,isLoading:!1,isError:!1,mode:"login",current:"username",user:{},error:{}},f=(e,r)=>{switch(r.type){case"TOGGLE":return{...g,isOpen:!e.isOpen};case"INIT":return{...e,isLoading:!0,isError:!1};case"SUBMIT":return{...e,isLoading:!1,isError:!1,current:r.current,user:{...e.user,[r.inputName]:r.inputValue}};case"REGISTER":return{...e,isLoading:!1,isError:!1,mode:"register"};case"LOGIN_SUCCESS":return window.location.reload(),{...e,isLoading:!1,isError:!1};case"LOGIN_ERROR":return{...e,isLoading:!1,isError:!0,error:r.error?r.error:{message:"An error occurred."}};default:throw new Error}};function h(){const e=t.a.useRef(),[r,a]=t.a.useReducer(f,g),n=e=>{e.preventDefault(),a({type:"TOGGLE"})},o=()=>t.a.createElement("a",{href:"/login.php",title:"Login",onClick:n,className:"user user-unknown"},t.a.createElement(E.b,{className:"user-avatar thumbnail"}),t.a.createElement("span",{className:"user-username"},"Login"));let l;r.isError?l=t.a.createElement("div",{className:"error"},r.error.hasOwnProperty("message")?r.error.message:"An error occurred"):"login"===r.mode?"username"===r.current?l="Erm... What's your name again?":"password"===r.current&&(l=`That's right! I remember now! Your name is ${r.user.username}!`):"register"===r.mode&&(l="We don't have anyone registered by that name. Would you like to register?");const c=()=>"username"===r.current?t.a.createElement(i,{name:"username",placeholder:"Username or Email",padding:17,autofocus:!0}):t.a.createElement(i,{type:"password",name:"password",placeholder:"Password",padding:17,autofocus:!0}),m=()=>"Register form here....";return t.a.createElement(t.a.Fragment,null,t.a.createElement(o,null),t.a.createElement(s.a,{open:r.isOpen,close:n},t.a.createElement("form",{id:"loginform",ref:e,onSubmit:async n=>{n.preventDefault(),a({type:"INIT"});const t=e.current[r.current].value;if("username"===r.current){const e=await fetch("/api/login/"+t,{method:"GET",mode:"same-origin",credentials:"same-origin"});if(e.ok){const r=await e.json();a({type:"SUBMIT",inputName:"username",inputValue:r.collection.items[0].username,current:"password"})}else a({type:"REGISTER"})}else if("password"===r.current){const e={...r.user,password:t},n=await fetch("/api/login",{method:"POST",mode:"same-origin",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(n.ok)a({type:"LOGIN_SUCCESS"});else{const e=await n.json();console.log(n,e),a({type:"LOGIN_ERROR",error:e.collection.errors[0]})}}else a({type:"LOGIN_ERROR",error:"An unknown error occurred."})},className:r.isLoading?"loading":void 0},t.a.createElement("div",{id:"loginform-nav"},t.a.createElement(p,null,t.a.createElement(p.Item,{selected:!0},t.a.createElement("a",{href:"#login"},"New Name")),t.a.createElement(p.Item,null,t.a.createElement("a",{href:""},"Blue")),t.a.createElement(p.Item,null,t.a.createElement("a",{href:""},"Gary")),t.a.createElement(p.Item,null,t.a.createElement("a",{href:""},"John")))),t.a.createElement("div",{id:"loginform-rival"}),t.a.createElement("div",{id:"loginform-message"},l),t.a.createElement("div",{id:"loginform-input"},"login"===r.mode?t.a.createElement(c,null):t.a.createElement(m,null)),t.a.createElement("div",{id:"loginform-submit"},r.isLoading?t.a.createElement(t.a.Fragment,null,t.a.createElement(E.a,{className:"loading"}),t.a.createElement("span",null,"Professor Oak is thinking")):t.a.createElement("button",{type:"submit",disabled:r.isLoading},"Submit")))))}}}]);
//# sourceMappingURL=Login_bundle.js.map